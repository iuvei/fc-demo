#第5章 &nbsp;&nbsp; 绘制图形
- <a href="#no1">5.1 canvas元素的基础知识</a>
- <a href="#no2">5.2 使用路径</a>
- <a href="#no3">5.3 绘制渐变图形</a>
- <a href="#no4">5.4 绘制变形图形</a>
- <a href="#no5">5.5 图形组合</a>
- <a href="#no5">5.6 给图形绘制阴影</a>
- <a href="#no5">5.7 使用图像</a>
- <a href="#no5">5.8 绘制文字</a>
- <a href="#no5">5.9 补充知识</a>


##<a name="no1">5.1 canvas元素的基础知识</a>

###5.1.1 在页面中放置`canvas`元素

**如下所示：**

	<!DOCTYPE html>
	<html lang="en">
	<head>
	  <meta charset="UTF-8">
	  <title>canvas元素实例</title>
	  <script src="canvas.js"></script>
	</head>
	<body onload="draw('canvas');">
	  <h1>canvas元素实例</h1>
	  <canvas id="canvas" width="400" height="300"></canvas>
	</body>
	</html>

###5.1.2 绘制矩形
> 在`canvas`元素绘制图形时，需要经过几个步骤：（html代码如5.1.1所示，这里主要指canvas.js）

 1. 取得`canvas`元素。
 2. 取得上下文（`context`）。
 3. 填充与绘制边框。
 	- 填充（`fill`）：填满图形内部。
 	- 绘制（`stroke`）：不填满图形内部，只绘制图形的外框。
 4. 设定绘图样式（`style`）。
 5. 指定线宽。
 6. 指定颜色值。
 7. 绘制矩形。
 	- `context.fillRect(x,y,width,height)`
 	- `context.strokeRect(x,y,width,height)`

**如下所示：**

	function draw(id){
	  var canvas = document.getElementById(id);
	
	  if(canvas == null) {
	    return false;
	  }
	
	  var context = canvas.getContext('2d');
	  context.fillStyle = '#fe4';
	  context.fillRect(0, 0, 400, 300);
	  context.fillStyle = 'red';
	  context.strokeStyle = 'blue';
	  context.lineWidth = 1;
	  context.fillRect(50, 50, 100, 100);
	  context.strokeRect(50, 50, 100, 100);
	}
![canvas绘制圆形](http://7xre9h.com1.z0.glb.clouddn.com/1.png)

##<a name="no2">5.2 使用路径</a>

###5.2.1 绘制圆形

> 想要绘制其他图形，需要使用路径。同样的，绘制开始时还是需要取得图形上下文，然后需要执行如下步骤。（html代码如5.1.1所示）

 1. 开始创建路径。
 	- 使用图形上下文对象的`beginPath`方法。`context.beginPath();`
 2. 创建图形的路径。
 	- `context.arc(x,y,radius,startAngle,endAngle,anticlockwise);`
 3. 路径创建完成后，关闭路径。
 	- `context.closePath();`
 4. 设定绘制样式，然后绘制方法，绘制路径。
 	- `context.fillStyle = 'rgba(255,0,0,.25)';`
 	- `context.fill();`

**如下所示：**

	function draw(id){
	  var canvas = document.getElementById(id);
	
	  if(canvas == null) {
	    return false;
	  }
	
	  var context = canvas.getContext('2d');
	  context.fillStyle = '#ef3';
	  context.fillRect(0, 0, 400, 300);
	  var n = 0;
	  for(var i = 0; i < 10; i++){
	    context.beginPath();
	    context.arc(i * 25, i * 25, i * 10, 0, Math.PI * 2, true);
	    context.closePath();
	    context.fillStyle = 'rgba(255, 0, 0, 0.25)';
	    context.fill();
	  }
	}
![canvas绘制圆形](http://7xre9h.com1.z0.glb.clouddn.com/2.png)
###5.2.2 如果没有关闭路径会怎样？
**如下所示：**

	function draw(id){
	  var canvas = document.getElementById(id);
	
	  if(canvas == null) {
	    return false;
	  }
	
	  var context = canvas.getContext('2d');
	  context.fillStyle = '#ef3';
	  context.fillRect(0, 0, 400, 300);
	  var n = 0;
	  for(var i = 0; i < 10; i++){
	    //context.beginPath();
	    context.arc(i * 25, i * 25, i * 10, 0, Math.PI * 2, true);
	    //context.closePath();
	    context.fillStyle = 'rgba(255, 0, 0, 0.25)';
	    context.fill();
	  }
	}
![canvas绘制圆形](http://7xre9h.com1.z0.glb.clouddn.com/3.png)

###5.2.3  moveTo 与 lineTo

> 绘制直线时，一般会用到`moveTo 与 lineTo`两种方法。

**如下所示：**

	function draw(id){
	  var canvas = document.getElementById(id);
	
	  if(canvas == null) {
	    return false;
	  }
	
	  var context = canvas.getContext('2d');
	  context.fillStyle = '#ef3';
	  context.fillRect(0, 0, 400, 300);
	  
	  var n = 0;
	  var dx = 150;
	  var dy = 150;
	  var s = 100;
	  context.beginPath();
	  context.fillStyle = 'rgb(100, 255, 100)';
	  context.strokeStyle = 'rgb(0, 0, 100)';
	  var x = Math.sin(0);
	  var y = Math.cos(0);
	  var dig = Math.PI / 15 * 11;
	
	  for(var i = 0; i < 30; i++){
	    var x = Math.sin(i * dig);
	    var y = Math.cos(i * dig);
	    context.lineTo(dx + x * s, dy + y * s);
	  }
	
	  context.closePath();
	  context.fill();
	  context.stroke();
	}

![canvas绘制圆形](http://7xre9h.com1.z0.glb.clouddn.com/4.png)

###5.2.4 使用`bezierCurveTo`绘制贝济埃曲线

> `context.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);`

**如下所示：**

	function draw(id){
	  var canvas = document.getElementById(id);
	
	  if(canvas == null) {
	    return false;
	  }
	
	  var context = canvas.getContext('2d');
	  context.fillStyle = '#ef3';
	  context.fillRect(0, 0, 400, 300);
	  
	  var n = 0;
	  var dx = 150;
	  var dy = 150;
	  var s = 100;
	  context.beginPath();
	  context.globalCompositeOpeartion = 'and';
	  context.fillStyle = 'rgb(100, 255, 100)';
	  context.strokeStyle = 'rgb(0, 0, 100)';
	  var x = Math.sin(0);
	  var y = Math.cos(0);
	  var dig = Math.PI / 15 * 11;
	  context.moveTo(dx, dy);
	  for(var i = 0; i < 30; i++){
	    var x = Math.sin(i * dig);
	    var y = Math.cos(i * dig);
	    context.bezierCurveTo(dx + x * s, dy + y * s - 100, dx + x * s + 100, dy + y * s, dx + x * s, dy + y * s);
	  }
	
	  context.closePath();
	  context.fill();
	  context.stroke();
	}

![canvas绘制圆形](http://7xre9h.com1.z0.glb.clouddn.com/5.png)


##<a name="no3">5.3 绘制渐变图形</a>

###5.3.1 绘制线性渐变

- `context.createLinearGradient(xStart, yStart, xEnd, yEnd);`
-  `context.addColorStop(offset, color);`  // 设置渐变颜色

**如下所示：**

	function draw(id){
	  var canvas = document.getElementById(id);
	
	  if(canvas == null) {
	    return false;
	  }
	
	  var context = canvas.getContext('2d');
	  var g1 = context.createLinearGradient(0,0,0,300);
	  g1.addColorStop(0,'rgb(255,255,0)');
	  g1.addColorStop(1,'rgb(0,255,255)');
	  context.fillStyle = g1;
	  context.fillRect(0, 0, 400, 300);
	
	  var n = 0;
	  var g2 = context.createLinearGradient(0,0,300,0);
	  g2.addColorStop(0,'rgba(0,0,255,0.5)');
	  g2.addColorStop(1,'rgba(255,0,0,0.5)');
	  for(var i = 0; i < 10; i++){
	    context.beginPath();
	    context.fillStyle = g2;
	    context.arc(i * 25, i * 25, i * 10, 0, Math.PI * 2, true);
	    context.closePath();
	    context.fill();
	  }
	}

![canvas绘制圆形](http://7xre9h.com1.z0.glb.clouddn.com/6.png)

###5.3.2 绘制径向渐变

- `context.createRadialGradient(xStart, yStart, radiusStart, xEnd, yEnd, radiusEnd);`

**如下所示：**
	
	function draw(id){
	  var canvas = document.getElementById(id);
	
	  if(canvas == null) {
	    return false;
	  }
	
	  var context = canvas.getContext('2d');
	  var g1 = context.createRadialGradient(400,0,0,400,0,400);
	  g1.addColorStop(0.1,'rgb(255,255,0)');
	  g1.addColorStop(0.3,'rgb(255,0,255)');
	  g1.addColorStop(1,'rgb(0,255,255)');
	  context.fillStyle = g1;
	  context.fillRect(0, 0, 400, 300);
	
	  var n = 0;
	  var g2 = context.createRadialGradient(250,250,0,250,250,300);
	  g2.addColorStop(0.1,'rgba(255,0,0,0.5)');
	  g2.addColorStop(0.7,'rgba(255,255,0,0.5)');
	  g2.addColorStop(1,'rgba(255,0,0,0.5)');
	  for(var i = 0; i < 10; i++){
	    context.beginPath();
	    context.fillStyle = g2;
	    context.arc(i * 25, i * 25, i * 10, 0, Math.PI * 2, true);
	    context.closePath();
	    context.fill();
	  }
	}

![canvas绘制圆形](http://7xre9h.com1.z0.glb.clouddn.com/7.png)